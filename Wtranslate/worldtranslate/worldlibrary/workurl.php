<?php  defined( '_WorldTranslate' ) or die( 'Restricted access' ); class xMSEhq {var $_uri = null;var $_scheme = null;var $_host = null;var $_port = null;var $_user = null;var $_pass = null;var $_path = null;var $_query = null;var $_fragment = null;var $_vars = array ();function __construct($uri = null) {if ($uri !== null) {$this->parse($uri);}}function ZYkL() {return $this->_host;}function &ZZkLBUMXV($uri = 'SERVER') {static $instances = array();if (!isset ($instances[$uri])){if ($uri == 'SERVER'){if (isset($_SERVER['HTTPS']) && !empty($_SERVER['HTTPS']) && (strtolower($_SERVER['HTTPS']) != 'off')) {$https = 's://';}  else  {$https = '://';}if (!empty ($_SERVER['PHP_SELF']) && !empty ($_SERVER['REQUEST_URI'])) {$theURI = 'http' . $https . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI'];} else {$theURI = 'http' . $https . $_SERVER['HTTP_HOST'] . $_SERVER['SCRIPT_NAME'];if (isset($_SERVER['QUERY_STRING']) && !empty($_SERVER['QUERY_STRING'])) {$theURI .= '?' . $_SERVER['QUERY_STRING'];}}$theURI = urldecode($theURI);$theURI = str_replace('"', '"',$theURI);$theURI = str_replace('<', '<',$theURI);$theURI = str_replace('>', '>',$theURI);$theURI = preg_replace('/eval\((.*)\)/', '', $theURI);$theURI = preg_replace('/[\\\"\\\'][\\s]*javascript:(.*)[\\\"\\\']/', '""', $theURI);} else {$theURI = $uri;}$instances[$uri] = new xMSEhq($theURI);}return $instances[$uri];}function UFT($pathonly = false) {static $UFT;if (!isset($UFT)){$live_site='';if(trim($live_site) != '') {$uri =& xMSEhq::ZZkLBUMXV($live_site);$UFT['prefix'] = $uri->toString( array('scheme', 'host', 'port'));$UFT['path'] = rtrim($uri->toString( array('path')), '/\\');if(JPATH_BASE == JPATH_ADMINISTRATOR) {$UFT['path'] .= '/administrator';}}  else  {$uri             =& xMSEhq::ZZkLBUMXV();$UFT['prefix'] = $uri->toString( array('scheme', 'host', 'port'));if (strpos(php_sapi_name(), 'cgi') !== false && !empty($_SERVER['REQUEST_URI'])) {$UFT['path'] =  rtrim(dirname(str_replace(array('"', '<', '>', "'"), '', $_SERVER["PHP_SELF"])), '/\\');}  else  {$UFT['path'] =  rtrim(dirname($_SERVER['SCRIPT_NAME']), '/\\');}}}return $pathonly === false ? $UFT['prefix'].$UFT['path'].'/' : $UFT['path'];}function root($pathonly = false, $path = null) {static $root;if(!isset($root)){$uri            =& xMSEhq::ZZkLBUMXV(xMSEhq::UFT());$root['prefix'] = $uri->toString( array('scheme', 'host', 'port') );$root['path']   = rtrim($uri->toString( array('path') ), '/\\');}if(isset($path)) {$root['path']    = $path;}return $pathonly === false ? $root['prefix'].$root['path'].'/' : $root['path'];}function current() {static $current;if (!isset($current)){$uri     = & xMSEhq::ZZkLBUMXV();$current = $uri->toString( array('scheme', 'host', 'port', 'path'));}return $current;}function YMSMS($lang) {$uri     = & xMSEhq::ZZkLBUMXV();$current = $uri->toString( array('scheme', 'host', 'port', 'path','query'));if(preg_match("/worldlang/",$current)) {$current=preg_replace("/.worldlang=(.*)/i","",$current);}if(preg_match("/\?/",$current)) {$current=$current."&worldlang=".$lang;}  else  {$current=$current."?worldlang=".$lang;}return $current;}function parse($uri) {$retval = false;$this->_uri = $uri;if ($_parts = $this->yFTzC($uri)) {$retval = true;}if(isset ($_parts['query']) && strpos($_parts['query'], '&')) {$_parts['query'] = str_replace('&', '&', $_parts['query']);}$this->_scheme = isset ($_parts['scheme']) ? $_parts['scheme'] : null;$this->_user = isset ($_parts['user']) ? $_parts['user'] : null;$this->_pass = isset ($_parts['pass']) ? $_parts['pass'] : null;$this->_host = isset ($_parts['host']) ? $_parts['host'] : null;$this->_port = isset ($_parts['port']) ? $_parts['port'] : null;$this->_path = isset ($_parts['path']) ? $_parts['path'] : null;$this->_query = isset ($_parts['query'])? $_parts['query'] : null;$this->_fragment = isset ($_parts['fragment']) ? $_parts['fragment'] : null;if(isset ($_parts['query'])) parse_str($_parts['query'], $this->_vars);return $retval;}function toString($parts = array('scheme', 'user', 'pass', 'host', 'port', 'path', 'query', 'fragment')) {$query = $this->ZZCFVI_();$uri = '';$uri .= in_array('scheme', $parts)  ? (!empty($this->_scheme) ? $this->_scheme.'://' : '') : '';$uri .= in_array('user', $parts)    ? $this->_user : '';$uri .= in_array('pass', $parts)    ? (!empty ($this->_pass) ? ':' : '') .$this->_pass. (!empty ($this->_user) ? '@' : '') : '';$uri .= in_array('host', $parts)    ? $this->_host : '';$uri .= in_array('port', $parts)    ? (!empty ($this->_port) ? ':' : '').$this->_port : '';$uri .= in_array('path', $parts)    ? $this->_path : '';$uri .= in_array('query', $parts)    ? (!empty ($query) ? '?'.$query : '') : '';$uri .= in_array('fragment', $parts)? (!empty ($this->_fragment) ? '#'.$this->_fragment : '') : '';return $uri;}function ZZCFVI_($toArray = false) {if($toArray) {return $this->_vars;}if(is_null($this->_query)) {$this->_query = $this->SEFVI_($this->_vars);}return $this->_query;}function SEFVI_ ($params, $akey = null) {if ( !is_array($params) || count($params) == 0 ) {return false;}$out = array();if( !isset($akey) && !count($out) )  {unset($out);$out = array();}foreach ( $params as $key => $val ){if ( is_array($val) ) {$out[] = xMSEhq::SEFVI_($val,$key);continue;}$thekey = ( !$akey ) ? $key : $akey.'['.$key.']';$out[] = $thekey."=".urlencode($val);}return implode("&",$out);}function FTZCFVI_($query) {if(!is_array($query)) {if(strpos($query, '&') !== false){$query = str_replace('&','&',$query);}parse_str($query, $this->_vars);}if(is_array($query)) {$this->_vars = $query;}$this->_query = null;}function yFTzC($uri) {$parts = array();if (version_compare( phpversion(), '4.4' ) < 0){$regex = "<^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?>";$matches = array();preg_match($regex, $uri, $matches, PREG_OFFSET_CAPTURE);$authority = @$matches[4][0];if (strpos($authority, '@') !== false) {$authority = explode('@', $authority);@list($parts['user'], $parts['pass']) = explode(':', $authority[0]);$authority = $authority[1];}if (strpos($authority, ':') !== false) {$authority = explode(':', $authority);$parts['host'] = $authority[0];$parts['port'] = $authority[1];}  else  {$parts['host'] = $authority;}$parts['scheme'] = @$matches[2][0];$parts['path'] = @$matches[5][0];$parts['query'] = @$matches[7][0];$parts['fragment'] = @$matches[9][0];} else {$parts = @parse_url($uri);}return $parts;}}?>